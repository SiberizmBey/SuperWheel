<!DOCTYPE html>
<html>
<head>
    <title>Super Wheel Settings</title>
    <link rel="shortcut icon" href="icon.ico" type="image/x-icon">
    <link rel="stylesheet" href="settings.css">
    <style>
        /* Görseldeki gibi şık durması için ufak stil eklemesi */
        .card { background: #1a1a1a; border-radius: 15px; padding: 15px; margin-bottom: 10px; color: white; border: 1px solid #333; }
        .app-row { display: flex; gap: 5px; margin-bottom: 5px; }
        input[type="checkbox"] { cursor: pointer; }
    </style>
</head>
<body>
    <h3>Ayarlar</h3>
    
    <div class="card">
        <label>Mouse Buton ID (Orta: 3):</label>
        <input type="number" id="btnId" style="width: 50px; background: #333; color: white; border: none; padding: 5px;">
    </div>

    <div class="card">
        <label><input type="checkbox" id="autoStart"> Windows ile Başlat</label>
    </div>

    <div class="card">
        <label><input type="checkbox" id="gameMode"> Tam Ekran Oyunlarda Engelle</label>
    </div>

    <div class="card">
        <label><input type="checkbox" id="browserMode"> Tarayıcılarda Engelle (Chrome, Edge vb.)</label>
    </div>

    <div class="card">
        <h4>Uygulamalar</h4>
        <div id="appsContainer"></div>
        <button onclick="addAppRow()" style="background: #008cff; color: white; border: none; border-radius: 5px; padding: 5px 15px; cursor: pointer; margin-top: 10px;">+ Ekle</button>
    </div>

    <button class="save-btn" onclick="saveSettings()" style="width: 100%; padding: 15px; background: #28a745; color: white; border: none; border-radius: 10px; cursor: pointer; font-weight: bold; margin-top: 10px;">KAYDET</button>

    <script>
        const { ipcRenderer } = require('electron');

        function addAppRow(name = '', path = '') {
            const div = document.createElement('div');
            div.className = 'app-row';
            div.innerHTML = `
                <input type="text" placeholder="Ad" class="app-name" value="${name}" style="flex: 1; background: #333; color: white; border: none; padding: 5px;">
                <input type="text" placeholder="Yol" class="app-path" value="${path}" style="flex: 2; background: #333; color: white; border: none; padding: 5px;">
                <button onclick="this.parentElement.remove()" style="background:#ff4d4d; color:white; border:none; padding: 5px 10px; cursor:pointer;">X</button>
            `;
            document.getElementById('appsContainer').appendChild(div);
        }

        ipcRenderer.send('get-current-config');
        ipcRenderer.on('current-config-data', (event, config) => {
            // Veri varsa yükle, yoksa varsayılanı (true/false) bas
            document.getElementById('btnId').value = config.shortcutButton || 3;
            document.getElementById('autoStart').checked = !!config.autoStart;
            document.getElementById('gameMode').checked = config.gameMode !== undefined ? config.gameMode : true;
            document.getElementById('browserMode').checked = !!config.browserMode;
            
            document.getElementById('appsContainer').innerHTML = ''; 
            if(config.apps) config.apps.forEach(app => addAppRow(app.name, app.path));
        });

        function saveSettings() {
            const apps = Array.from(document.querySelectorAll('.app-row')).map(row => ({
                name: row.querySelector('.app-name').value,
                path: row.querySelector('.app-path').value
            }));

            const config = {
                shortcutButton: parseInt(document.getElementById('btnId').value),
                autoStart: document.getElementById('autoStart').checked,
                gameMode: document.getElementById('gameMode').checked,
                browserMode: document.getElementById('browserMode').checked,
                apps: apps
            };

            ipcRenderer.send('save-settings', config);
            alert("Ayarlar NexaBAG Studios kalitesiyle kaydedildi!");
        }
    </script>
</body>
</html>